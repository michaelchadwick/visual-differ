<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Visual Diff Report</title>
  <style>
    .diff-images {
      display: flex;
      gap: 1rem;
      margin: 1rem 0;
    }
    
    .diff-images img {
      max-width: 30vw;
      height: auto;
    }
  </style>
</head>
<body>
  <main>
  <h1>Visual Diff Report</h1>
  
  <p><strong>Status:</strong> <span aria-hidden="true">{{statusEmoji}}</span> {{statusText}}</p>
  
  <h2>Summary</h2>
  <ul>
    <li><strong>Total Images:</strong> {{totalImages}}</li>
    <li><strong>Different:</strong> {{diffCount}}</li>
    <li><strong>Removed:</strong> {{removedCount}}</li>
    <li><strong>Added:</strong> {{addedCount}}</li>
    <li><strong>Identical:</strong> {{identicalCount}}</li>
  </ul>

{{#if withDifferences.length}}
  <h2>Images with Differences ({{withDifferences.length}})</h2>
  {{#each withDifferences}}
  <div>
    <h3>{{name}}</h3>
    {{#if dimensionMismatch}}
      <p><strong><span aria-label="Warning">⚠️</span> Dimension mismatch:</strong> Baseline {{dimensionMismatch.baseline}}, Candidate {{dimensionMismatch.candidate}}</p>
    {{else}}
      <p><strong>Difference:</strong> {{diffPercentage}}%</p>
    {{/if}}
    <div class="diff-images">
      <a href="{{baselineImage}}"><img src="{{baselineImage}}" alt="Baseline screenshot for {{name}}" /></a>
      <a href="{{diffImage}}"><img src="{{diffImage}}" alt="Visual difference highlighting changed pixels in {{name}}"/></a>
      <a href="{{candidateImage}}"><img src="{{candidateImage}}" alt="Candidate screenshot for {{name}}" /></a>
    </div>
  </div>
  {{/each}}
{{/if}}

{{#if hasRemovedOrAdded}}
  <h2>Missing or New Files</h2>
  {{#if baselineOnly.length}}
    <h3>Removed from Candidate ({{baselineOnly.length}})</h3>
    <ul>
      {{#each baselineOnly}}
      <li>{{name}}</li>
      {{/each}}
    </ul>
  {{/if}}
  {{#if candidateOnly.length}}
    <h3>Added in Candidate ({{candidateOnly.length}})</h3>
    <ul>
      {{#each candidateOnly}}
      <li>{{name}}</li>
      {{/each}}
    </ul>
  {{/if}}
{{/if}}

{{#if withoutDifferences.length}}
  <h2>Identical Images ({{withoutDifferences.length}})</h2>
  <ul>
    {{#each withoutDifferences}}
    <li>{{name}}</li>
    {{/each}}
  </ul>
{{/if}}

  <hr>
  <p><em>Generated by visual-differ</em></p>
  </main>
</body>
</html>
